library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity top_cafetera is
  Port (
        enable: in std_logic;
        reset_top: in std_logic;
        clock_top: in std_logic;
        seleccion: out std_logic_vector(4 downto 0)
	boton: in std_logic;
	----aÃ±sdir botones
         );
end top_cafetera;


architecture behavioral of top_cafetera is

COMPONENT MaquinaDeEstados IS 
        PORT(
               boton_c,boton_l,reset, clk : in std_logic;
	       --presente: in std_logic;
               led_corto,led_largo,led_espera,led_listo : out std_logic;    
        );
END COMPONENT;
 
 COMPONENT contador
	GENERIC (max:integer:=30);
	PORT(
		clk : IN std_logic;
		rst : IN std_logic;
		enable : IN std_logic;          
		count : OUT std_logic_vector(4 downto 0);
		salida : OUT std_logic
		);
	END COMPONENT;
	
COMPONENT Debouncer is
            PORT(
                clk: IN std_logic;
                rst: IN STD_LOGIC;
                btn_in: IN STD_LOGIC;
                btn_out: OUT STD_LOGIC
                );
END COMPONENT;

COMPONENT sincronizador is
	    PORT(
	     clk: IN std_logic;
	     sync_in: IN std_logic;
	     sync_out: OUT STD_LOGIC
	     );
END COMPONENT;	    

signal btn_in: std_logic;
signal btn_out: std_logic;
signal boton_c: std_logic;
signal boton_l: std_logic;
signal led_corto: std_logic;
signal led_largo: std_logic;
signal led_espera: std_logic;
signal led_listo: std_logic;
signal sync_in: std_logic;
signal sync_out: std_logic;
signal cuenta:std_logic;

begin


maquina: MaquinaDeEstados PORT MAP (clk=>clock_top,
                    reset=>reset_top,
		    clk=>clock;
		    boton_c=> boton_c,
		    boton_l=> boton_l,
		    led_corto => led_corto, 
		    led_largo =>led_largo,
		    led_espera => led_espera,
		    led_listo => led_listo,
                    );

contador: contador PORT MAP (clk=>clock_top,
                    rst=>reset_top,
                    enable=> enable,
                    salida =>salida_top,
		    count => cuenta
                    );
		    
debouncer: Debouncer PORT MAP(
                clk => clk,
                rst => rst,
                btn_in => btn_in,
                btn_out =>btn_out
                );

sincronizador: sincronizador PORT MAP(
clk => clk,
sync_in => sync_in,
sync_out =>sync_out
);

end Behavioral;
